# Варианты использования (Use Cases)

## 1. Управление пользователями и аутентификация

### UC-01: Регистрация нового пользователя
*   **Действующее лицо:** Незарегистрированный пользователь
*   **Описание:** Пользователь предоставляет свои учетные данные (имя пользователя, email, пароль) для создания новой учетной записи.
*   **Предусловия:** Отсутствие учетной записи с таким же email или именем пользователя.
*   **Основной поток:**
    1.  Пользователь переходит на страницу регистрации.
    2.  Пользователь вводит имя пользователя, email и пароль.
    3.  Система проверяет уникальность имени пользователя и email.
    4.  Система хеширует пароль и создает новую учетную запись пользователя с ролью "инженер" (по умолчанию).
    5.  Система уведомляет пользователя об успешной регистрации.
*   **Пост-условия:** Создана новая учетная запись пользователя.
*   **Альтернативные потоки:**
    *   **3a.1:** Имя пользователя или email уже существуют. Система отображает сообщение об ошибке.

### UC-02: Вход в систему
*   **Действующее лицо:** Зарегистрированный пользователь
*   **Описание:** Пользователь предоставляет свои учетные данные (имя пользователя/email, пароль) для получения доступа к системе.
*   **Предусловия:** У пользователя есть зарегистрированная и активная учетная запись.
*   **Основной поток:**
    1.  Пользователь переходит на страницу входа.
    2.  Пользователь вводит имя пользователя/email и пароль.
    3.  Система проверяет предоставленные учетные данные.
    4.  Система генерирует JWT-токен.
    5.  Система предоставляет доступ к функциям, соответствующим роли пользователя.
*   **Пост-условия:** Пользователь успешно аутентифицирован.
*   **Альтернативные потоки:**
    *   **3a.1:** Неверные учетные данные. Система отображает сообщение об ошибке.
    *   **3b.1:** Учетная запись неактивна. Система отображает сообщение о неактивной учетной записи.

### UC-03: Просмотр профиля пользователя
*   **Действующее лицо:** Аутентифицированный пользователь
*   **Описание:** Пользователь просматривает информацию о своем профиле.
*   **Предусловия:** Пользователь аутентифицирован.
*   **Основной поток:**
    1.  Пользователь переходит на страницу профиля.
    2.  Система отображает информацию о пользователе (имя пользователя, email, роль, статус активности).
*   **Пост-условия:** Информация о пользователе отображена.

## 2. Управление проектами/объектами

### UC-04: Создание проекта
*   **Действующее лицо:** Менеджер
*   **Описание:** Менеджер создает новый строительный проект.
*   **Предусловия:** Пользователь аутентифицирован как "менеджер".
*   **Основной поток:**
    1.  Менеджер переходит на страницу создания проекта.
    2.  Менеджер вводит название и описание проекта.
    3.  Система создает новый проект и связывает его с менеджером как владельцем.
    4.  Система уведомляет менеджера об успешном создании проекта.
*   **Пост-условия:** Создан новый проект.
*   **Альтернативные потоки:**
    *   **3a.1:** Отсутствуют необходимые поля. Система отображает сообщение об ошибке.

### UC-05: Просмотр списка проектов
*   **Действующее лицо:** Менеджер, Инженер, Наблюдатель
*   **Описание:** Пользователь просматривает список доступных проектов.
*   **Предусловия:** Пользователь аутентифицирован.
*   **Основной поток:**
    1.  Пользователь переходит на страницу проектов.
    2.  Система отображает список проектов.
*   **Пост-условия:** Список проектов отображен.

### UC-06: Просмотр деталей проекта
*   **Действующее лицо:** Менеджер, Инженер, Наблюдатель
*   **Описание:** Пользователь просматривает подробную информацию о конкретном проекте.
*   **Предусловия:** Пользователь аутентифицирован. Проект существует.
*   **Основной поток:**
    1.  Пользователь выбирает проект из списка.
    2.  Система отображает детали проекта (название, описание, дата создания, владелец).
*   **Пост-условия:** Детали проекта отображены.

### UC-07: Редактирование проекта
*   **Действующее лицо:** Менеджер
*   **Описание:** Менеджер изменяет информацию о проекте.
*   **Предусловия:** Пользователь аутентифицирован как "менеджер" и является владельцем проекта.
*   **Основной поток:**
    1.  Менеджер выбирает проект для редактирования.
    2.  Менеджер изменяет название и/или описание проекта.
    3.  Система обновляет информацию о проекте.
    4.  Система уведомляет менеджера об успешном обновлении проекта.
*   **Пост-условия:** Информация о проекте обновлена.
*   **Альтернативные потоки:**
    *   **3a.1:** Пользователь не является владельцем проекта или не имеет достаточных прав. Система отображает сообщение об ошибке доступа.

### UC-08: Удаление проекта
*   **Действующее лицо:** Менеджер
*   **Описание:** Менеджер удаляет проект.
*   **Предусловия:** Пользователь аутентифицирован как "менеджер" и является владельцем проекта.
*   **Основной поток:**
    1.  Менеджер выбирает проект для удаления.
    2.  Система запрашивает подтверждение удаления.
    3.  Менеджер подтверждает удаление.
    4.  Система удаляет проект и связанные с ним дефекты, комментарии, вложения.
    5.  Система уведомляет менеджера об успешном удалении проекта.
*   **Пост-условия:** Проект удален.
*   **Альтернативные потоки:**
    *   **3a.1:** Пользователь не является владельцем проекта или не имеет достаточных прав. Система отображает сообщение об ошибке доступа.

## 3. Управление дефектами

### UC-09: Создание дефекта
*   **Действующее лицо:** Инженер, Менеджер
*   **Описание:** Инженер или менеджер регистрирует новый дефект в рамках проекта.
*   **Предусловия:** Пользователь аутентифицирован как "инженер" или "менеджер" и имеет доступ к проекту.
*   **Основной поток:**
    1.  Пользователь выбирает проект, в котором нужно создать дефект.
    2.  Пользователь заполняет форму создания дефекта (заголовок, описание, приоритет, исполнитель, сроки, вложения).
    3.  Система создает новый дефект.
    4.  Система уведомляет пользователя об успешном создании дефекта.
*   **Пост-условия:** Создан новый дефект.
*   **Альтернативные потоки:**
    *   **3a.1:** Отсутствуют необходимые поля. Система отображает сообщение об ошибке.

### UC-10: Просмотр списка дефектов
*   **Действующее лицо:** Менеджер, Инженер, Наблюдатель
*   **Описание:** Пользователь просматривает список дефектов.
*   **Предусловия:** Пользователь аутентифицирован.
*   **Основной поток:**
    1.  Пользователь переходит на страницу дефектов.
    2.  Система отображает список дефектов.
    3.  Пользователь может использовать поиск, сортировку и фильтрацию для уточнения списка.
*   **Пост-условия:** Список дефектов отображен.

### UC-11: Просмотр деталей дефекта
*   **Действующее лицо:** Менеджер, Инженер, Наблюдатель
*   **Описание:** Пользователь просматривает подробную информацию о конкретном дефекте.
*   **Предусловия:** Пользователь аутентифицирован. Дефект существует.
*   **Основной поток:**
    1.  Пользователь выбирает дефект из списка.
    2.  Система отображает детали дефекта (заголовок, описание, приоритет, статус, исполнитель, сроки, вложения, комментарии, история изменений).
*   **Пост-условия:** Детали дефекта отображены.

### UC-12: Редактирование дефекта
*   **Действующее лицо:** Инженер, Менеджер
*   **Описание:** Инженер или менеджер изменяет информацию о дефекте.
*   **Предусловия:** Пользователь аутентифицирован как "инженер" или "менеджер", является репортером, исполнителем дефекта или менеджером.
*   **Основной поток:**
    1.  Пользователь выбирает дефект для редактирования.
    2.  Пользователь изменяет поля дефекта (например, описание, приоритет, исполнитель, сроки, статус).
    3.  Система обновляет информацию о дефекте и фиксирует изменения в истории.
    4.  Система уведомляет пользователя об успешном обновлении дефекта.
*   **Пост-условия:** Информация о дефекте обновлена, история изменений зафиксирована.
*   **Альтернативные потоки:**
    *   **3a.1:** Пользователь не имеет достаточных прав. Система отображает сообщение об ошибке доступа.

### UC-13: Изменение статуса дефекта
*   **Действующее лицо:** Инженер, Менеджер
*   **Описание:** Инженер или менеджер изменяет статус дефекта (Новая → В работе → На проверке → Закрыта/Отменена).
*   **Предусловия:** Пользователь аутентифицирован как "инженер" или "менеджер", является исполнителем дефекта или менеджером.
*   **Основной поток:**
    1.  Пользователь выбирает дефект.
    2.  Пользователь выбирает новый статус из предопределенного списка.
    3.  Система проверяет допустимость перехода статуса.
    4.  Система обновляет статус дефекта и фиксирует изменение в истории.
    5.  Система уведомляет пользователя об успешном изменении статуса.
*   **Пост-условия:** Статус дефекта обновлен.
*   **Альтернативные потоки:**
    *   **3a.1:** Недопустимый переход статуса. Система отображает сообщение об ошибке.
    *   **3b.1:** Пользователь не имеет достаточных прав. Система отображает сообщение об ошибке доступа.

### UC-14: Удаление дефекта
*   **Действующее лицо:** Менеджер, Инженер (репортер дефекта)
*   **Описание:** Менеджер или репортер дефекта удаляет дефект.
*   **Предусловия:** Пользователь аутентифицирован как "менеджер" или является репортером дефекта.
*   **Основной поток:**
    1.  Пользователь выбирает дефект для удаления.
    2.  Система запрашивает подтверждение удаления.
    3.  Пользователь подтверждает удаление.
    4.  Система удаляет дефект и связанные с ним комментарии и вложения.
    5.  Система уведомляет пользователя об успешном удалении дефекта.
*   **Пост-условия:** Дефект удален.
*   **Альтернативные потоки:**
    *   **3a.1:** Пользователь не является репортером дефекта или менеджером. Система отображает сообщение об ошибке доступа.

## 4. Управление комментариями и вложениями

### UC-15: Добавление комментария к дефекту
*   **Действующее лицо:** Инженер, Менеджер, Наблюдатель
*   **Описание:** Пользователь добавляет комментарий к дефекту.
*   **Предусловия:** Пользователь аутентифицирован. Дефект существует.
*   **Основной поток:**
    1.  Пользователь открывает детали дефекта.
    2.  Пользователь вводит текст комментария.
    3.  Система сохраняет комментарий, связывая его с дефектом и автором.
    4.  Система отображает новый комментарий.
*   **Пост-условия:** Комментарий добавлен к дефекту.

### UC-16: Просмотр комментариев к дефекту
*   **Действующее лицо:** Инженер, Менеджер, Наблюдатель
*   **Описание:** Пользователь просматривает комментарии, связанные с дефектом.
*   **Предусловия:** Пользователь аутентифицирован. Дефект существует.
*   **Основной поток:**
    1.  Пользователь открывает детали дефекта.
    2.  Система отображает список комментариев к дефекту.
*   **Пост-условия:** Комментарии отображены.

### UC-17: Редактирование комментария
*   **Действующее лицо:** Автор комментария, Менеджер
*   **Описание:** Автор комментария или менеджер изменяет свой комментарий.
*   **Предусловия:** Пользователь аутентифицирован и является автором комментария или менеджером.
*   **Основной поток:**
    1.  Пользователь выбирает комментарий для редактирования.
    2.  Пользователь изменяет текст комментария.
    3.  Система обновляет комментарий.
    4.  Система уведомляет пользователя об успешном обновлении комментария.
*   **Пост-условия:** Комментарий обновлен.
*   **Альтернативные потоки:**
    *   **3a.1:** Пользователь не является автором комментария или менеджером. Система отображает сообщение об ошибке доступа.

### UC-18: Удаление комментария
*   **Действующее лицо:** Автор комментария, Менеджер
*   **Описание:** Автор комментария или менеджер удаляет комментарий.
*   **Предусловия:** Пользователь аутентифицирован и является автором комментария или менеджером.
*   **Основной поток:**
    1.  Пользователь выбирает комментарий для удаления.
    2.  Система запрашивает подтверждение удаления.
    3.  Пользователь подтверждает удаление.
    4.  Система удаляет комментарий.
    5.  Система уведомляет пользователя об успешном удалении комментария.
*   **Пост-условия:** Комментарий удален.
*   **Альтернативные потоки:**
    *   **3a.1:** Пользователь не является автором комментария или менеджером. Система отображает сообщение об ошибке доступа.

### UC-19: Добавление вложения к дефекту
*   **Действующее лицо:** Инженер, Менеджер
*   **Описание:** Пользователь добавляет файл (изображение, документ) к дефекту.
*   **Предусловия:** Пользователь аутентифицирован как "инженер" или "менеджер". Дефект существует.
*   **Основной поток:**
    1.  Пользователь открывает детали дефекта.
    2.  Пользователь выбирает файл для загрузки.
    3.  Система загружает файл, сохраняет его на сервере и создает запись о вложении, связывая с дефектом и загрузившим пользователем.
    4.  Система отображает новое вложение.
*   **Пост-условия:** Вложение добавлено к дефекту.

### UC-20: Просмотр вложений к дефекту
*   **Действующее лицо:** Инженер, Менеджер, Наблюдатель
*   **Описание:** Пользователь просматривает вложения, связанные с дефектом.
*   **Предусловия:** Пользователь аутентифицирован. Дефект существует.
*   **Основной поток:**
    1.  Пользователь открывает детали дефекта.
    2.  Система отображает список вложений к дефекту (названия файлов, миниатюры).
    3.  Пользователь может скачать или просмотреть вложение.
*   **Пост-условия:** Вложения отображены.

### UC-21: Удаление вложения
*   **Действующее лицо:** Автор вложения, Менеджер
*   **Описание:** Автор вложения или менеджер удаляет вложение.
*   **Предусловия:** Пользователь аутентифицирован и является автором вложения или менеджером.
*   **Основной поток:**
    1.  Пользователь выбирает вложение для удаления.
    2.  Система запрашивает подтверждение удаления.
    3.  Пользователь подтверждает удаление.
    4.  Система удаляет файл с сервера и запись о вложении из базы данных.
    5.  Система уведомляет пользователя об успешном удалении вложения.
*   **Пост-условия:** Вложение удалено.
*   **Альтернативные потоки:**
    *   **3a.1:** Пользователь не является автором вложения или менеджером. Система отображает сообщение об ошибке доступа.

## 5. Отчетность и аналитика

### UC-22: Экспорт отчета по дефектам
*   **Действующее лицо:** Менеджер, Наблюдатель
*   **Описание:** Менеджер или наблюдатель экспортирует данные о дефектах в формате CSV/Excel.
*   **Предусловия:** Пользователь аутентифицирован как "менеджер" или "наблюдатель".
*   **Основной поток:**
    1.  Пользователь переходит на страницу отчетов.
    2.  Пользователь выбирает параметры для фильтрации дефектов (по проекту, статусу, приоритету, исполнителю, датам).
    3.  Пользователь инициирует экспорт.
    4.  Система генерирует файл CSV/Excel с отфильтрованными данными о дефектах.
    5.  Система предлагает пользователю скачать файл.
*   **Пост-условия:** Отчет о дефектах экспортирован и доступен для скачивания.
*   **Альтернативные потоки:**
    *   **3a.1:** Пользователь не имеет достаточных прав. Система отображает сообщение об ошибке доступа.

### UC-23: Просмотр аналитических отчетов
*   **Действующее лицо:** Менеджер, Наблюдатель
*   **Описание:** Менеджер или наблюдатель просматривает аналитические отчеты (графики, статистика) по дефектам и проектам.
*   **Предусловия:** Пользователь аутентифицирован как "менеджер" или "наблюдатель".
*   **Основной поток:**
    1.  Пользователь переходит на страницу аналитики.
    2.  Система отображает различные графики и статистические данные (например, количество дефектов по статусам, по приоритетам, по исполнителям, динамика появления и закрытия дефектов).
    3.  Пользователь может применять фильтры для просмотра данных по конкретным проектам или временным периодам.
*   **Пост-условия:** Аналитические отчеты отображены.
*   **Альтернативные потоки:**
    *   **3a.1:** Пользователь не имеет достаточных прав. Система отображает сообщение об ошибке доступа.
